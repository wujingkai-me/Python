<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Oxygen:wght@300;400;700&family=Red+Hat+Display:wght@400;500;700&display=swap" rel="stylesheet"> 
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/vue@2.7.0/dist/vue.js"></script>
  <style>
    body {font-family: 'Red Hat Display', sans-serif;
    user-select:none;}
  </style>
  <title>Amazon工具合集</title>
</head>
<body class="m-5 h-full bg-slate-50">
  <!-- <div id="logo" class="text-4xl mb-10 font-bold text-gray-400"><font color="red">A</font>mazon <font color="green">T</font>itle <font color="orange">V</font>erify</div> -->
  <div id="root">
    <input type="text" v-model="title" v-on:input="isEmpty" name="title" class="
    outline-none
    border-2
    border-blue-700
    p-2
    pl-6
    rounded-2xl
    w-[70%]
    mr-10
    transition
    focus:drop-shadow-md
  " placeholder="在这里输入你的标题"/>
  <span @click="title=''" style="cursor:pointer" class="transition hover:text-red-600">字符长度：<span class="font-bold text-blue-600">{{ title.length }}</span></span>
  <button id="Check" @click="Check" class="
    w-[80px]
    rounded-lg
    ml-3
    p-2
    bg-blue-700
    text-white
    transition

    hover:-translate-y-1
  ">校验</button>
  <button id="Check" @click="title=convertFirstLetterToUpperCase(title)" class="
    w-[100px]
    rounded-lg
    ml-3
    p-2
    bg-orange-600
    text-white
    transition

    hover:-translate-y-1
  ">首字母大写</button>
  <div class="
  w-full
  h-[200px]
  mt-20
  text-left" id="verify">
  
  <template v-if="isGood && isShow">
    <h2 class="text-green-600 text-8xl font-bold">YES😊 That's good.</h2>

    <template v-if="hasSuggesstion">
      <h1>我们的建议</h1>
      <ul>
        <li v-for="item in suggesstionItems" class="list-disc ml-5">{{item}}</li>
      </ul>
    </template>
    <template v-else>
      我们没有任何的建议
    </template>

  </template>


  <template v-else-if="isShow">
    <h2 class="text-red-600 font-bold text-8xl">NO😥, So Bad</h2>
    
    <input type="checkbox" @click="isPrep"> 提示我的是介词 <br><br>
    含有重复字符超过3次, 请勿恶意累加关键词, 如果检测为介词可忽略(and/or/with/of/for...) 其他语言可能有所不同, <b>注意甄别</b>
    <br> <br>
    
    <span class="text-2xl leading-tight text-left pt-10" v-html="text"></span>
    <template v-if="title.length >= 180">
      字符长度需要注意：<strong>{{title.length}}</strong>
    </template>
  
  </template>
</div>
  </div>
</body>
</html>


<script>
  new Vue({
    el: "#root",
    data: {
      title: "",
      isShow: false,
      isGood: false,
      really: false,
      hasSuggesstion: false,
      suggesstionItems: {},
      text: ""
    },
    methods: {
      isEmpty() {
        if(this.title == "") {
          this.isGood = false
          this.really = false
          this.isShow = false 
        }
      },
      convertFirstLetterToUpperCase(str) {
        var splitStr = str.toLowerCase().split(' ');
        for (var i = 0; i < splitStr.length; i++) {
            splitStr[i] = splitStr[i].charAt(0).toUpperCase() + splitStr[i].substring(1);     
        }
        
        return splitStr.join(' '); 
      },
      Check() {
        if(this.really) return
        verifyTitle = this.title.split(" ")
        var repeatList = []
        const repeatCount = 2; // 重复次数

        for(let i = 0; i < verifyTitle.length; i ++) {
          let repeatNum = 0
          let repeatElement

          // 查找重复元素
          for(let j = i + 1; j < verifyTitle.length; j ++) {
            if(verifyTitle[i] == verifyTitle[j])
              repeatNum ++
              repeatElement = verifyTitle[i]
          }
               
          // 查找是否有没有首字母大写的
          if(verifyTitle[i][0] != this.convertFirstLetterToUpperCase(verifyTitle[i][0])){
            this.hasSuggesstion = true
            this.suggesstionItems.cap = "首字母可能没有大写"
          
          } else {
            this.hasSuggesstion = false
            this.suggesstionItems = {}
          }

          // 查找是否有全首字母大写的
          console.log(verifyTitle[i] + "<============>" + verifyTitle[i].toUpperCase())
          if(verifyTitle[i] == verifyTitle[i].toUpperCase()) {
            this.hasSuggesstion = true
            this.suggesstionItems.fullCap = "该首字母全大写：" + verifyTitle[i] + ", 可能是违禁词, 请检查"
          } else if(!this.hasSuggesstion){
            this.hasSuggesstion = false
            this.suggesstionItems = {}
          }
          if(repeatNum >= repeatCount) {
            repeatList.push(repeatElement)
          }
        }

        this.isGood = true

        for (let index = 0; index < repeatList.length; index++) {
          for(let original = 0; original < verifyTitle.length; original++){
            if(repeatList[index] == verifyTitle[original]){
              verifyTitle[original] = "<b><font color='red'>" + verifyTitle[original] + "</font></b>"
              this.isGood = false
            }
            else {
              verifyTitle[original] = "<font color='grey'>" + verifyTitle[original] + "</font>"
            }
          }
        }

        this.text = verifyTitle.join(" ")
        this.isShow = true
        
        // console.log(verifyTitle.toString())
      },
      isPrep(e) {
        if(e.target.checked)
          this.isGood = true
          this.really = true
      }
    }


  })
</script>